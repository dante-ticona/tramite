<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0055)https://www.sigplusweb.com/sigwebtablet_autokeydemo.htm -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
  
	<meta http-equiv="origin-trial" content="Anx9M3J0aHLpGAMe3zP5qpGiORIM9XVPn0kCEMBGlIzpUAmigST4zEpCybneyUtCHHt8N6xJqNEI/eczFA3E8QoAAAB6eyJvcmlnaW4iOiJodHRwczovL3d3dy5zaWdwbHVzd2ViLmNvbTo0NDMiLCJmZWF0dXJlIjoiQWxsb3dTeW5jWEhSSW5QYWdlRGlzbWlzc2FsIiwiZXhwaXJ5IjoxNTk1MTc3MTgxLCJpc1N1YmRvbWFpbiI6dHJ1ZX0=">

  <title>Firma Path</title>



  <script type="text/javascript" src="https://desa-tramitesip.gestora.bo/js/SigWebTablet.js.descarga"></script>
  <!--SigWebTablet.js is required for SigWeb to function-->
  <!--SigWebTablet.js is located here and may be copied for your own use-->
  <!--http://www.sigplusweb.com/SigWebTablet.js-->

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script type="text/javascript">
  var tmr;

  var resetIsSupported = false;

  window.onload = function(){
		if(IsSigWebInstalled()){
			resetIsSupported = GetResetSupported();
			if(!resetIsSupported){
				var sigweb_link = document.createElement("a");
				sigweb_link.href = "https://www.topazsystems.com/software/sigweb.exe";
				sigweb_link.innerHTML = "https://www.topazsystems.com/software/sigweb.exe";

				var note = document.getElementById("sigWebVrsnNote");
				note.innerHTML = "There is a newer version of SigWeb available here: ";
				note.appendChild(sigweb_link);
			}
		}
		else{
			alert("Unable to communicate with SigWeb. Please confirm that SigWeb is installed and running on this PC.");
		}
	}

  function GetResetSupported(){
    var minSigWebVersionResetSupport = "1.6.4.0";

    if(isOlderSigWebVersionInstalled(minSigWebVersionResetSupport)){
      console.log("Old SigWeb version installed.");
      return false;
    }
    return true;
  }

  function isOlderSigWebVersionInstalled(cmprVer){
    var sigWebVer = GetSigWebVersion();
    if(sigWebVer != ""){
      return isOlderVersion(cmprVer, sigWebVer);
    } else{
      return false;
    }
  }

  function isOlderVersion (oldVer, newVer) {
    const oldParts = oldVer.split('.')
    const newParts = newVer.split('.')
    for (var i = 0; i < newParts.length; i++) {
      const a = parseInt(newParts[i]) || 0
      const b = parseInt(oldParts[i]) || 0
      if (a < b) return true
      if (a > b) return false
    }
    return false;
  }

  function onSign()
  {
    if(IsSigWebInstalled()){
      var ctx = document.getElementById('cnv').getContext('2d');
      SetDisplayXSize( 500 );
      SetDisplayYSize( 100 );
      SetTabletState(0, tmr);
      SetJustifyMode(0);
      ClearTablet();
      SetKeyString("0000000000000000");
      SetEncryptionMode(0);
      if(tmr == null)
      {
        tmr = SetTabletState(1, ctx, 50);
      }
      else
      {
        SetTabletState(0, tmr);
        tmr = null;
        tmr = SetTabletState(1, ctx, 50);
      }
    } else{
      alert("Unable to communicate with SigWeb. Please confirm that SigWeb is installed and running on this PC.");
    }
  }

  function onClear()
  {
    ClearTablet();
  }

  function onDone()
  {
    console.log('64 bits');
    if(NumberOfTabletPoints() == 0)
    {
      alert("Por favor firme antes de continuar");
    }
    else
    {
      SetTabletState(0, tmr); //deactivate connection

      //NOW, EXTRACT THE SIGNATURE IN THE TOPAZ BIOMETRIC FORMAT -- SIGSTRING
      //OR AS A BASE64-ENCODED PNG IMAGE
      //OR BOTH

      //********************USE THIS SECTION IF YOU WISH TO APPLY AUTOKEY TO YOUR TOPAZ SIGNATURE
      //READ ABOUT AUTOKEY AND THE TOPAZ SIGNATURE FORMAT HERE: http://topazsystems.com/links/robustsignatures.pdf
      //AUTOKEY IS CRITICAL TO SAVING AN eSIGN-COMPLIANT SIGNATURE
      //AUTOKEY ONLY APPLIES TO THE TOPAZ-FORMAT SIGSTRING AND DOES NOT APPLY TO AN IMAGE OF THE SIGNATURE
      //AUTOKEY ALLOWS THE DEVELOPER TO CRYPTOGRAPHICALLY BIND THE TOPAZ SIGNATURE TO A SET OF DATA
      //THE PURPOSE OF THIS IS TO SHOW THAT THE SIGNATURE IS BEING APPLIED TO THE DATA YOU PASS IN USING AutoKeyAddData()
      //IN GENERAL TOPAZ RECOMMENDS REPLICATING A TRADITIONAL 'PAPER AND PEN' APPROACH
      //IN OTHER WORDS, IF YOU WERE TO PRINT OUT ON PAPER THE TERMS/INFORMATION THE SIGNER IS SUPPOSED TO READ AND AGREE WITH
      //THE DATA ON THIS PAPER IS WHAT SHOULD IN WHOLE BE PASSED INTO AUTOKEYADDANSIDATA() DIGITALLY
      //THE TOPAZ SIGSTRING IS THEN BOUND TO THIS DATA, AND CAN ONLY BE SUCCESSFULLY DECRYPTED LATER USING THIS DATA
      //AUTOKEYADDDATA IS DEPRECATED AND REPLACED BY AUTOKEYADDANSIDATA
      var CryptoData = "";
      CryptoData = "This represents sample data the signer reads and is agreeing to when signing.";
      CryptoData = CryptoData + "Concatenate all this data into a single variable.";
      AutoKeyAddANSIData(CryptoData); //PASS THE DATA IN TO BE USED FOR AUTOKEY
      SetEncryptionMode(2);
      //*******END AUTOKEY SECTION

      //NOTE THAT THE AUTOKEY SECTION ABOVE IS NOT REQUIRED TO RETURN A TOPAZ SIGSTRING
      //BUT IT IS STRONGLY RECOMMENDED IF YOU REQUIRE eSIGN COMPLIANCE
      //RETURN THE TOPAZ-FORMAT SIGSTRING
      SetSigCompressionMode(1);
      //alert("KEYSTRING:" + GetKeyString());

      //THIS RETURNS THE SIGNATURE IN TOPAZ'S OWN FORMAT WITH BIOMETRIC INFORMATION

      //TO RETURN THIS SIGSTRING LATER TO A NEW WEB PAGE USING SIGWEB, REPEAT THE CODE FROM THIS FUNCTION ABOVE STARTING AFTER SetTabletState(0, tmr)
      //BUT AT THE END USE SetSigString() INSTEAD OF GetSigString()
      //NOTE THAT SetSigString() TAKES 2 ARGUMENTS
      //SetSigString(str SigString, context canvas)

      //TO RETURN A BASE64-ENCODED PNG IMAGE OF THE SIGNATURE
      SetImageXSize(500);
      SetImageYSize(100);
      SetImagePenWidth(5);
      GetSigImageB64(SigImageCallback); //PASS IN THE FUNCTION NAME SIGWEB WILL USE TO RETURN THE FINAL IMAGE
    }


  }


  function SigImageCallback( str )
  {
    var datos = {
        png64:str,
        cas_id:{{ $id }}
    };
      axios.post('/api/guardarFirma', datos)
        .then(function (response) {
            console.log(response.data);
        })
        .catch(function (error) {
            console.error(error);
        });

        window.history.back();

  }

  function endDemo()
  {
    ClearTablet();
    SetTabletState(0, tmr);
  }

  function close(){
    if(resetIsSupported){
      Reset();
    } else{
      endDemo();
    }
  }

  //Perform the following actions on
  //	1. Browser Closure
  //	2. Tab Closure
  //	3. Tab Refresh
  window.onbeforeunload = function(evt){
    close();
    clearInterval(tmr);
    evt.preventDefault(); //For Firefox, needed for browser closure
  };

</script>

  
</head>
<body>
<p>El ID es de al firma: {{ $id }}</p>



  <table border="1" cellpadding="0" width="500">
    <tbody><tr>
      <td height="100" width="500">
        <canvas id="cnv" name="cnv" width="500" height="100"></canvas>
      </td>
    </tr>
  </tbody></table>


  <br>
    <canvas name="SigImg" id="SigImg" width="500" height="100"></canvas>
    <p id="sigWebVrsnNote" style="font-family: Arial;"></p>


    <form action="https://www.sigplusweb.com/sigwebtablet_autokeydemo.htm#" name="FORM1">
      <p>
        <input id="SignBtn" name="SignBtn" type="button" value="Iniciar" onclick="javascript:onSign()">&nbsp;&nbsp;&nbsp;&nbsp;
        <input id="button1" name="ClearBtn" type="button" value="Limpiar" onclick="javascript:onClear()">&nbsp;&nbsp;&nbsp;&nbsp;

        <input id="button2" name="DoneBtn" type="button" value="Mandar" onclick="javascript:onDone()">&nbsp;&nbsp;&nbsp;&nbsp;

        <input type="HIDDEN" name="bioSigData" value="FFFFFFFFA784FA102E01000000000000F88F246B95F057001EF2CF21442737268A31E85ADF4DCDE4A71DD13FB2E5F45E1363F35AC306507E8AD439C43D5D00B72FE78BC4C5422E81F82E42E860A13707B803549EB23B84FAC19E8D1E2EB2775F70F105A680BE54C9B1135063E3BBC59BE11430113B1592AD90F44D5B683FACFA9D00293C1CF51E178D0814010E1C5362025BE59AFB25D87158A18A08FD11CF01555306D1346F2C125E3E1E65E5CC817776DA4DF39089EBFF5C0C767E72177A95A95AAF89234491EE16668DCDE07A1F827AFBEF28D3FADD653B2231C09AD56DA7475746DF0638704D3E33366DA87B7CB3F66EF2D4E0F33153C9815D33EA7FE28A58490AF4062A620B34EB4687A2108004F624468724137E88D8F0CE93539F2FA7B1C2818CCA40931DBAFC6FCBC7A8B09121148FD2D29484709BD1C6E5172C711252B024662AE94CAD50A1FA268FD16CA62D137A1D3866389356B214A9CACEAB1D0B04EC2E5A0FAA8C375FD0403D743E465FA475CEB1126FC19F79C4B6779E68FE22E37966ACEC7DDDF835734C2219F880DB787277F8A08B9B588F8C7BD90373B557EF6C0168227312502AADE7CFF84372F2634D9AFEF0742214B21F8EE668C14E967B93A8BAF41DA3B0FEB8521EA745B531F86971457C5194D6A3DC24D45EFFC159D97CB9D46767F72D5BC51D4212C575A59AC6DB1903ECFF0F5C0650F94CAFAD1458572BA3D9152CEAFB58D7E45870F3391A75A5E233939B15D01D961240257925EBF37958C1FCBBB2344A1936F1D7DFD3DD286EF02E1EA57BC22482D81DFC6E62E2A5E3CFD8E50F129ADD1BF0C2B1BE92C1B0673140B1BCD87187611C2D1B0C58B6AEFAA08A360CDE6EB3C23EFD99353423E1952CFF604AB8B2DA38A968F867E2AF1C72718149BE5AD9BC844834F2F7E76774A8F8757A6B75E37CF8543F32E4A3DDC2CC4A98EF79D8404D748761A139704879FDEFF3F9E0C3B57442EEBE3972A0C6EA3364A3227849FFE4575109300D7183AAE9C37E5E0B318B7E9549804BB051E84077E344771882075504CE7ABE78A21BB6AD172C116F361489D47A4727E81D463B897718191EE05EA54A9FD900A075F63028FF6F5020F1619E4AEEBD2B342D6F72478EA0D9D6E2E994A03DFB4B285538168CC6EF4C3AE6DF6C4BF1F2588497B36D5EB183DF13344931FBBD67B1BE3AC96176995DD4EA7EF854FD0E15F7243DCAB7D4E7DB49818B67E8FFCAE22F28A8662A88D186029A29265042310DC8EF20EBF93840C23E50726498F02FFB0216F4F76D0D1807A9FD4EE21BCA3582F2AC8D552A11B35AAC8954DAFC743BEFC7FE73FD21C8B2E906A99A6D0E8E6F2DC85BF8DC0466A3B77F35ECF985F9589E1D22FD43AE1AF83A7372BBE5FA94BBF4BA11A81B4E955B11DC1BA0DCD5915871E4135D39CF3550CC07143C8A8A00A08C12701D04F7BB144200E78577892A4B94FDEC41759E8EBB5AE9E9205D7CDC02D27126C680B7240813DBC5E6179B2D779C4A27C2AEF96D3FA29F9EF8DEAB9C629209357FFBD5764253B1935B448C1633055E52E5FB8FB4DE428ADC9A81ED07FEA7747658C518573AAC5F1A2840ADEBCB91796C40BC1CA9F27B72B8E92E3F56F30A92D872397AAB1F0FBFFA75CF5AA18F8B66CA0942853F2927FA8B4CE64E5679165D71FC8564DEB238611B55634B20E8FAE68B522A8A7BAACF22E3A7DC98FCAD5D5DBAE821EC9E1FC8FA95BB847137272FC4BBD4839A95B5037A06E88640FC98E619C903A305D614A0CD8FB112EA9C45CB12FD615DAAED2AC1E6613FFBCDE0613E40173AC23CE7EBE56457E40D88C9648EA2BBA5E022BEEC2C5B8BD5E18779FBA20B597731CA796BF0A257EDABA8E9F4C4ECFEC6BEA70DEEBB60A2900ABC790E7B376DA889EB484FA55B50410FB6050A36BCB3198D0ABDF2791EFE57636712B0E1B24D18772F12E7D216553785A43C6EFACA80F759AD39703C4DD56775FF1EC620B71E29D95B4804B6C0CE63F5FBA2095495DA32733E0693FE1933F97A9EBB903647831451580A98AB569BA13714FC3091D6A96DE1C8E0BF815F00539BEB05C0DB9429A6385ABA72900B4B635B90D334AF10473EE3CAF34FA3F268C026D5EF032B3699A5A13DE8A2DC27F81AC23EE99CFDBB257A734BF4CC70D60F3EB9A517ECE227B5DE404005499C48E229B573776791F96BECD9C86D607A39672555FB4F91C917ADC2D08080ADADE284B4AD97634D384B241E3F2DFCA6B6963D48F698EEC3EB04BD1E270711889421B56D4E9FDD7B241AA90215A9781913E3EADFB59A7DEFB52EBE8E16390D1D5B34A8976729C14A8AE4A88AB6D04F5CF92EFC37EC54EC05C903CB86898C6F2E2D77E499C596F83A04640AC8B2D49FAB8413144F45105D81A6D6AEB2A25116FD4F5C44EAEB3F138A2F29825ACE7C66BA3465DD79C34114A07D1BFAE9D31CCAD98C0495A048775F723D34C88ADC882A8CE78EF3230D69D4FD4A8B7F07DCC29AA835C4994B44BCA580760EB928BF642A8009E875169265DA1EA1D91F51936262945160E7AA7361F848A254FDF8C231D19B96D543BE7B795637BD84809ECCADC1F2DEBF861160F5FF6C55E126242E69021545F3873794E2353C94E0E9B6121311FFC3751B723B66D204974EBFF92ECC1AA2D598EAF3B9F18FA360395087247DDB5CC41C8D1A6B01247DBA45ADD7B1C70919F381890F412D3660F14C9B9EA189EC092D365275437D3A14817B8DEBA50BDB352C45078B262FEA2B94B9E8C824724569D73CE9D418EFB45E45C60007F967CB0DE14D01DC6DF72725395166126C3463044886DBB566E41BE5C96FA63C65B0A5D8D0741643AB21F13939AB920376167C57119507B7B26C78F0960F028B24C8E7B004F325992F04AF3C8C053F173AA63CE853FEF0743DC535AAE690A47AFC6DB41762D88C056893738BB14AC7CD5CD971993E64354838A0C6972B75F5633400ECBF52FBBF37D7B215C28B66822A10AC3334C23ED18F448DF89705442E4419709A3090460E5BF83195E1AB94D4147874F14EFEF73886A5D3CE649027B96F26C356C3CD9B97A2A70F1F9DA8CC5E9C9C9A5F31EC08710DCACD63B92EEB70B194C5E00DAC66099A135B1F11D2D173A8D4A7507DA36F9BD913900CD362C868AAC8BEC9BC9EF0449CD0210EB3EF5391DAA46465116D2AFA2EBD95E7CE50330D5038C3DBAAD75A474102B717A78A247E4BEE294534C53FB0056935B989BDCF6AB4ADC2BF9E95C45601F10440194EBB5BFEABB5D0AD4F443E49EDD01245767035D94894B2996C2F349926F90ED270D10EF4834E900ED7BC5361021C14BDD76603E0FE24763C4D776EE7CF60C51F46DEE517A57FFDD817D06D486994639028BF126CE00327B712412E648BCBECCB9352634AE02F72E27434B34FC1248D37E2E9E34FD5B4F0EBA7E0165E0C10F5E442A41F">
          <input type="HIDDEN" name="sigImgData">
            <br>
              <br>
              
              </p>
            </form>
            <br><br>

          
          
</body></html>